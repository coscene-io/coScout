apiVersion: skaffold/v2beta28
kind: Config
build:
  tagPolicy:
    customTemplate:
      template: "{{.FOO}}-{{.BAR}}"
      components:
        - name: FOO
          dateTime:
            format: "2006-01-02"
            timezone: "UTC"
        - name: BAR
          gitCommit:
            ignoreChanges: true
  artifacts:
    - image: coseus.azurecr.io/cos-agent
      custom:
        buildCommand: docker buildx build --file Dockerfile.cos --secret id=netrc,src=/home/runner/.netrc --tag $IMAGE --push $BUILD_CONTEXT
        dependencies:
          paths: [ "go.mod", "**/**.go" ]
  local:
    useBuildkit: true
